@namespace Blatternfly.Components
@inherits BaseComponent
@implements IAsyncDisposable
@inject IPortalConnector Connector

@code {
  [Parameter] public EventCallback OnConnect { get; set; }
  [Parameter] public EventCallback OnDisconnect { get; set; }
  
  [Parameter] 
  public bool IsOpen
  {
    get => _isOpen;
    set
    {
      _isOpen = value;
      if (_isOpen)
      {
        _ = Connector.Connect(this);
        _ = OnConnect.InvokeAsync();
      }
      else
      {
        _ = Connector.Disconnect();
        _ = OnDisconnect.InvokeAsync();
      }
    }
  }
  
  public async ValueTask DisposeAsync()
  {
    if (Connector is not null)
    {
      await Connector.Disconnect();
      await OnDisconnect.InvokeAsync();
    }
  }
  
  private bool _isOpen;
}